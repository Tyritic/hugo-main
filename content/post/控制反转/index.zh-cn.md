---
date : '2024-11-03T15:06:44+08:00'
draft : false
title : '控制反转'
image : ""
categories : ["SpringBoot"]
tags : ["后端开发"]
description : "SpringBoot框架中的控制反转"
---

## 什么是控制反转（IOC)

IOC意味着将你设计好的对象交给容器控制，而不是传统的在你的对象内部直接控制。以右图为例![](73d67b2030772821a4bd2e6b746ecd38.png)

IOC容器作为中间位置“第三方”，也就是，使得A、B、C、D这四个对象没有了耦合关系，齿轮之间的传动全部依靠IOC容器，全部对象的控制权上交给IOC容器，所以IOC容器成了整个系统的关键核心，它起到一个“粘合剂”的作用，把系统中所有对象粘合在一起发挥作用。

## IOC的关键点

- **谁控制谁**：
  - 传统Java SE程序设计，我们直接在对象内部通过new进行创建对象，是程序主动去创建依赖对象；
  - 而IOC是有专门一个容器来创建这些对象，即由Ioc容器来控制对象的创建；
- **控制了什么**
  - 那就是主要控制了外部资源获取（不只是对象包括比如文件等）。
- **什么是反转**：
  - 传统应用程序是由我们自己在对象中主动控制去直接获取依赖对象，也就是正转；
  - 而反转则是由容器来帮忙创建及注入依赖对象
- **为什么是反转**：因为由容器帮我们查找及注入依赖对象，对象只是被动的接受依赖对象。
- **哪些方面反转了**：依赖对象的获取被反转了。

## IOC的过程

- 所有的类都会在Spring容器中登记，告诉spring你是个什么东西，你需要什么东西，
- 然后spring会在系统运行到适当的时候，把你要的东西主动给你，同时也把你交给其他需要你的东西。
- 所有的类的创建、销毁都由 spring来控制，也就是说控制对象生存周期的不再是引用它的对象，而是spring。
- 对于某个具体的对象而言，以前是它控制其他对象，现在是所有对象都被spring控制，所以这叫控制反转。

## Bean对象的声明

| 注解        | 说明                   | 位置                                            |
| ----------- | ---------------------- | ----------------------------------------------- |
| @Component  | 声明Bean对象的基本注解 | 不属于以下三类时使用该注解                      |
| @Service    | @Component的衍生注解   | 标注在ServiceImpl类上                           |
| @Controller | @Component的衍生注解   | 标注在Controller类上                            |
| @Repository | @Component的衍生注解   | 标注在数据访问类上（现在有mybatis，使用评论少） |

**注意事项**

- 声明bean的时候，可以通过value属性指定bean的名字，如果没有指定，默认为类名首字母小写
- 使用以上四个注解都可以声明bean，但是在springboot集成web开发中，声明控制器bean只能用@Controller.

## Bean组件扫描

声明bean的四大注解，要想生效，还需要被组件扫描注解 **@ComponentScan** 扫描。
**@ComponentScan** 注解虽然没有显式配置，但是实际上已经包含在了启动类声明注解 **@SpringBootApplication** 中，默认扫描的范围是启动类所在包及其子包。
